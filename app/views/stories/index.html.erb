<section class="section">
<% if notice %>
<aside id="notice"><%= notice %></aside>
<% end %>
<table class="bd-spacing-table table">
  <thead>
    <tr>
      <th>Name</th>
      <th>User</th>
      <th>Story format</th>
      <th>Passages</th>
    </tr>
  </thead>

  <tbody>
    <% @stories.each do |story| %>
      <tr>
        <td><%= story.name %></td>
        <td><%= story.user&.email %>
        <td><%= story.story_format&.name.to_s + ' ' + story.story_format&.version.to_s %></td>
        <td><%= story.passages.count.to_s %></td>
        <td><%= link_to 'Show', story %></td>
        <td><%= link_to 'Read', formatted_stories_path(id: story.id), target: "_blank" %>
        <% if current_user&.id == story.user_id %>
          <td><%= link_to 'Edit', edit_story_path(story) %></td>
        <% elsif current_user %>
          <td><%= button_to 'Copy and Edit', fork_story_path(story), method: :post, class: "button is-small" %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<p><%= link_to 'Start a New Story', new_story_path %></p>
<p><%= link_to 'Import a Twine Story', new_import_path %></p>
</section>
